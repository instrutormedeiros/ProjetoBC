<!doctype html>
<html lang="pt-BR"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Admin - Bravo Charlie</title>
<style>body{font-family:Arial;padding:20px}input,button{padding:8px;margin:6px}table{width:100%;border-collapse:collapse}td,th{border:1px solid #ddd;padding:8px}</style>
</head><body>
  <h2>Painel Admin - Projeto Bravo Charlie</h2>
  <p>Senha:</p>
  <input id="pw" type="password" />
  <button id="btn-auth">Entrar</button>

  <div id="admin-area" style="display:none">
    <h3>Marcar usuário como PREMIUM (PIX confirmado)</h3>
    <input id="uemail" placeholder="email do aluno" />
    <button id="btn-add">Marcar como premium (365 dias)</button>

    <h3>Carregar inscritos</h3>
    <button id="btn-load">Carregar inscritos</button>
    <div id="list"></div>
  </div>

<script>
const ADMIN_PASSWORD = "MedeirosAdmin2025";
const API = "https://script.google.com/macros/s/AKfycbzbnB7HLTEzClwotviGMsFtZI02D30kqptFFENz1kJ1MsIm4Gq6juhN9xvMWGuapQb4kA/exec";
const TOKEN = "BCBRAVO123!@#";

document.getElementById('btn-auth').addEventListener('click', ()=>{
  if(document.getElementById('pw').value === ADMIN_PASSWORD){
    document.getElementById('admin-area').style.display='block';
  } else alert('Senha incorreta');
});

document.getElementById('btn-add').addEventListener('click', async ()=>{
  const email = document.getElementById('uemail').value.trim().toLowerCase();
  if(!email){ alert('Informe email'); return; }
  const res = await fetch(`${API}?action=upgrade&token=${TOKEN}&email=${encodeURIComponent(email)}`);
  const j = await res.json();
  alert(j.message || JSON.stringify(j));
});

document.getElementById('btn-load').addEventListener('click', async ()=>{
  const res = await fetch(`${API}?action=list&token=${TOKEN}`);
  const j = await res.json();
  if(j && j.users){
    let html = '<table><tr><th>Email</th><th>Name</th><th>Status</th><th>Acesso até</th></tr>';
    j.users.forEach(u=>{
      html += `<tr><td>${u.email}</td><td>${u.name||''}</td><td>${u.status||''}</td><td>${u.acesso_ate||''}</td></tr>`;
    });
    html += '</table>';
    document.getElementById('list').innerHTML = html;
  } else document.getElementById('list').innerHTML = 'nenhum usuário';
});
</script>
</body></html>
